<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CS:GO Fictional Sim - SFX Edition</title>
    <style>
        :root {
            --blue: #4b69ff; --purple: #8847ff; --pink: #d32ee6; --red: #eb4b4b; --gold: #caab05;
            --bg: #0b0e11; --panel: rgba(22, 25, 30, 0.9);
        }
        body { background: radial-gradient(circle, #222b35 0%, #0b0e11 100%); color: white; font-family: sans-serif; margin: 0; display: flex; height: 100vh; }
        
        #side-nav { width: 300px; background: var(--panel); border-right: 1px solid #333; padding: 20px; display: flex; flex-direction: column; }
        #game-area { flex-grow: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; }

        /* Spinner UI */
        .viewport { width: 800px; height: 180px; background: #111; position: relative; overflow: hidden; border: 2px solid #444; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .strip { display: flex; position: absolute; left: 0; top: 0; }
        .item { width: 160px; height: 180px; flex-shrink: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; border-right: 1px solid #222; text-align: center; font-size: 11px; }
        .item img { width: 120px; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.5)); }
        .pointer { position: absolute; left: 50%; top: 0; width: 4px; height: 100%; background: #ffcc00; z-index: 10; transform: translateX(-50%); box-shadow: 0 0 15px #ffcc00; }

        /* Rarity Borders */
        .r-mil-spec { border-bottom: 5px solid var(--blue); }
        .r-restricted { border-bottom: 5px solid var(--purple); }
        .r-classified { border-bottom: 5px solid var(--pink); }
        .r-covert { border-bottom: 5px solid var(--red); }
        .r-special { border-bottom: 5px solid var(--gold); background: radial-gradient(circle, rgba(202,171,5,0.1) 0%, transparent 80%); }

        .controls { margin-top: 30px; display: flex; gap: 15px; }
        button { background: #de9b35; color: black; border: none; padding: 15px 40px; font-weight: bold; cursor: pointer; text-transform: uppercase; }
        button:disabled { background: #444; color: #888; cursor: not-allowed; }
        select { padding: 15px; background: #222; color: white; border: 1px solid #444; }

        .inv-item { display: flex; align-items: center; gap: 10px; background: #1a1e24; margin-bottom: 8px; padding: 8px; font-size: 12px; border-left: 3px solid #555; }
        .inv-item img { width: 40px; }
    </style>
</head>
<body>

<div id="side-nav">
    <h2>INVENTORY</h2>
    <div id="inv-list" style="overflow-y: auto; flex-grow: 1;"></div>
    <hr style="width:100%; border:0; border-top:1px solid #333;">
    <p>Global Low: <b id="best-float" style="color:#5cb85c">1.000000</b></p>
</div>

<div id="game-area">
    <div class="controls">
        <select id="case-select">
            <option value="chroma">Chroma Case</option>
            <option value="bravo">Operation Bravo</option>
            <option value="gamma">Gamma Case</option>
        </select>
        <button id="openBtn" onclick="startSpin()">Open Case</button>
    </div>

    <div class="viewport">
        <div class="pointer"></div>
        <div id="strip" class="strip"></div>
    </div>
</div>

<script>
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function playTick() {
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain); gain.connect(audioCtx.destination);
        osc.type = 'sine'; osc.frequency.setValueAtTime(150, audioCtx.currentTime);
        gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
        osc.start(); osc.stop(audioCtx.currentTime + 0.1);
    }

    const DATABASE = {
        chroma: [
            { name: "M4A1-S | Chantico's Fire", rarity: "covert", img: "https://community.cloudflare.steamstatic.com/economy/image/-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXH5ApeO4YmlhxYQknCRvCo04DEVlxkKgpou-6kejhjx2zFJTwS09S5h7-Eh_L7Pb7um21f48ZoiO_F89Smi62t_0VkYm-iLdORclM9NV_Q-wW2we7qhJS4v8icm3Vgu3V37XfD30vgY_YpZ_o" },
            { name: "AK-47 | Elite Build", rarity: "mil-spec", img: "https://community.cloudflare.steamstatic.com/economy/image/-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXH5ApeO4YmlhxYQknCRvCo04DEVlxkKgpot7HxfDhjx2zJcmRD4uO7kZKKm_L1NYTdn2xZ_Ity2b6S9N6kiwPl-0A4Y2_xcY7AIVRrMF3Y_1m-w7_v1pC_v57XiSw9Xv7O_S0" }
        ],
        bravo: [
            { name: "AK-47 | Fire Serpent", rarity: "covert", img: "https://community.cloudflare.steamstatic.com/economy/image/-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXH5ApeO4YmlhxYQknCRvCo04DEVlxkKgpot7HxfDhjx2zJcmRD4uO7kZKKm_L1NYTdn2xZ_Ity2b6S9N6kiwPl-0A4Y2_xcY7AIVRrMF3Y_1m-w7_v1pC_v57XiSw9Xv7O_S0" }
        ],
        gamma: [
            { name: "â˜… Karambit | Gamma Doppler", rarity: "special", img: "https://community.cloudflare.steamstatic.com/economy/image/-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXH5ApeO4YmlhxYQknCRvCo04DEVlxkKgpovbSsLQJf1f_BYi59_8i_m46EhP_7Pb7um21f48ZoiO_F896giwLir0VvYG_2IoDHcwVvN1HS-FC8yL_shsC_v57OzHdg6Sgg7XfD30vgvN8_yS0" }
        ]
    };

    let bestFloat = 1.0;

    function getSkin(caseKey) {
        const rand = Math.random() * 100;
        let rarity = "mil-spec";
        if (rand < 0.3) rarity = "special";
        else if (rand < 1.5) rarity = "covert";
        
        const pool = DATABASE[caseKey].filter(s => s.rarity === rarity);
        const finalPool = pool.length > 0 ? pool : DATABASE[caseKey];
        return {...finalPool[Math.floor(Math.random() * finalPool.length)]};
    }

    function startSpin() {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const caseKey = document.getElementById('case-select').value;
        const btn = document.getElementById('openBtn');
        const strip = document.getElementById('strip');
        
        btn.disabled = true;
        strip.style.transition = 'none';
        strip.style.transform = 'translateX(0)';
        strip.innerHTML = '';

        const winIndex = 40;
        const winner = getSkin(caseKey);
        const winFloat = Math.random();

        for (let i = 0; i < 50; i++) {
            const s = (i === winIndex) ? winner : getSkin(caseKey);
            const div = document.createElement('div');
            div.className = `item r-${s.rarity}`;
            div.innerHTML = `<img src="${s.img}"><br>${s.name}`;
            strip.appendChild(div);
        }

        setTimeout(() => {
            strip.style.transition = 'transform 5s cubic-bezier(0.1, 0, 0.05, 1)';
            strip.style.transform = `translateX(-${(winIndex * 160) - 320}px)`;
            
            // Sound ticking simulation
            for(let j=0; j<40; j++) {
                setTimeout(playTick, Math.pow(j, 2) * 3);
            }
        }, 50);

        setTimeout(() => {
            btn.disabled = false;
            if(winFloat < bestFloat) {
                bestFloat = winFloat;
                document.getElementById('best-float').innerText = bestFloat.toFixed(6);
            }
            const inv = document.getElementById('inv-list');
            inv.innerHTML = `<div class="inv-item" style="border-left-color:var(--${winner.rarity})">
                <img src="${winner.img}"> <div><b>${winner.name}</b><br><small>${winFloat.toFixed(6)}</small></div>
            </div>` + inv.innerHTML;
        }, 5200);
    }
</script>
</body>
</html>
